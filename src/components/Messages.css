.messages-page {
  width: 100%;
  height: 100%;
}

.messages-container {
  display: grid;
  grid-template-columns: 360px 1fr 320px;
  height: calc(100vh - 112px);
  padding: 16px;
}

.messages-page.in-conversation .messages-container {
  grid-template-columns: 1fr;
  height: 100vh;
  height: 100dvh;
  padding: 0;
}
.messages-page.in-conversation .messages-sidebar,
.messages-page.in-conversation .messages-details {
  display: none;
}

.messages-sidebar,
.messages-chat,
.messages-details {
  background: var(--md-sys-color-surface);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Sidebar deve ocupar toda a altura disponível e a lista preencher o restante */
.messages-sidebar { height: 100%; }

/* Sidebar */
.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--md-sys-color-outline);
}
.sidebar-header h2 {
  font-size: 18px;
  margin: 0;
}

.sidebar-search {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
}
.sidebar-search .search-icon { opacity: .6; }
.sidebar-search input {
  flex: 1;
  height: 40px;
  border: 1px solid var(--md-sys-color-outline);
  border-radius: 999px;
  padding: 0 40px 0 36px;
  background: var(--md-sys-color-surface-container);
}
.sidebar-search .search-clear { visibility: hidden; }

.conversations-list {
  overflow: auto;
  flex: 1;
}
.conversation-item {
  width: 100%;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  border: 0;
  background: transparent;
  cursor: pointer;
  text-align: left;
  border-left: 3px solid transparent;
}
.conversation-item:hover { background: var(--md-sys-color-surface-container-low); }
.conversation-item.active { background: var(--md-sys-color-surface-container); border-left-color: var(--md-sys-color-primary); }
.conversation-item .avatar {
  width: 44px; height: 44px; border-radius: 50%; overflow: hidden;
  background: var(--md-sys-color-surface-container-high);
}
.conversation-item .avatar img { width: 100%; height: 100%; object-fit: cover; }
.conversation-meta { flex: 1; }
.conversation-meta .row-1,
.conversation-meta .row-2 { display: flex; align-items: center; justify-content: space-between; }
.conversation-meta .name { font-weight: 600; }
.conversation-meta .time { font-size: 12px; opacity: .6; }
.conversation-meta .last-message { font-size: 13px; opacity: .8; }
.conversation-meta .badge {
  min-width: 18px; height: 18px; border-radius: 9px;
  background: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); font-size: 11px;
  display: inline-flex; align-items: center; justify-content: center; padding: 0 6px;
}

/* Chat */
.chat-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 16px; border-bottom: 1px solid var(--md-sys-color-outline);
}
.chat-peer { display: flex; align-items: center; gap: 12px; }
.chat-peer .avatar { width: 40px; height: 40px; border-radius: 50%; overflow: hidden; background: var(--md-sys-color-surface-container-high); }
.chat-peer .avatar img { width: 100%; height: 100%; object-fit: cover; }
.peer-info h3 { font-size: 16px; margin: 0; }
.peer-info .status { font-size: 12px; opacity: .6; }

.chat-body {
  flex: 1; overflow: auto; padding: 16px; background: var(--md-sys-color-surface);
}
.day-separator { text-align: center; margin: 8px 0 16px; }
.day-separator span { font-size: 12px; opacity: .7; background: var(--md-sys-color-surface-container-highest); padding: 4px 10px; border-radius: 999px; }

.message-row { display: flex; margin-bottom: 10px; }
.message-row.you { justify-content: flex-end; }
.message-row.peer { justify-content: flex-start; }
.bubble {
  max-width: 70%; padding: 10px 12px; border-radius: 16px;
  position: relative; background: var(--md-sys-color-surface-container-high);
}
.message-row.you .bubble { background: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); }
.bubble .meta { display: block; text-align: right; font-size: 11px; opacity: .8; margin-top: 6px; }

.chat-input {
  display: flex; align-items: center; gap: 10px; padding: 10px; border-top: 1px solid var(--md-sys-color-outline);
}
.input-box { flex: 1; display: flex; align-items: center; gap: 8px; border: 1px solid var(--md-sys-color-outline); border-radius: 999px; padding: 0 12px; background: var(--md-sys-color-surface-container); }
.input-box input { flex: 1; height: 44px; border: 0; background: transparent; }
.input-box .prefix, .input-box .suffix { opacity: .7; }

/* Details */
.details-header { padding: 12px 16px; border-bottom: 1px solid var(--md-sys-color-outline); }
.details-header h4 { margin: 0; font-size: 14px; opacity: .8; }
.details-section { padding: 12px 16px; }
.section-title { font-size: 12px; text-transform: uppercase; opacity: .6; margin-bottom: 8px; }
.participant { display: flex; align-items: center; gap: 10px; }
.avatar.small { width: 32px; height: 32px; border-radius: 50%; overflow: hidden; background: var(--md-sys-color-surface-container-high); }
.participant-info .name { font-weight: 600; display: block; }
.participant-info .handle { font-size: 12px; opacity: .6; }
.media-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
.media-thumb { width: 100%; padding-top: 100%; border-radius: 10px; background: var(--md-sys-color-surface-container-high); }

/* Utility */
.only-desktop { display: block; }
.mobile-only { display: none; }

.new-message-fab { position: fixed; right: 16px; bottom: 88px; }

/* Responsividade */
@media (max-width: 1279px) {
  .messages-container { grid-template-columns: 320px 1fr; }
  .messages-details { display: none; }
}

@media (max-width: 959px) {
  .messages-container {
    grid-template-columns: 1fr;
    height: calc(100vh - 96px);
  }
  .messages-page.in-conversation .messages-container {
    height: 100vh;
    height: 100dvh;
  }
  .only-desktop { display: none; }
  .mobile-only { display: inline-flex; }
  .messages-chat { order: 2; }
  .messages-sidebar { order: 1; }
  .chat-header { position: sticky; top: 0; background: var(--md-sys-color-surface); z-index: 2; }
  .chat-input { position: sticky; bottom: 0; background: var(--md-sys-color-surface); z-index: 2; }

  /* Em mobile, quando NÃO está em conversa, esconder o chat */
  .messages-page:not(.in-conversation) .messages-chat { display: none; }
  /* Em mobile, quando está em conversa, esconder a lista */
  .messages-page.in-conversation .messages-sidebar { display: none; }
}


